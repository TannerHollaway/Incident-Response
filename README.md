# Incident-Response

<details>
  <summary>Brute Force attempt</summary>
  
  Incident Response: Brute Force Attack on Azure Windows VM
Overview
Incident Summary
On August 12, 2024, an alert was triggered for a potential brute force attack on the Azure-hosted Windows virtual machine (windows-vm). The alert, generated by Microsoft Sentinel, indicated a successful brute force attempt from an external IP address (203.135.22.130) located in Lahore, Pakistan.

<p align="center">
<img src="https://github.com/user-attachments/assets/a74ca45d-0f7e-4550-9b30-eaf0f1656ee0" height="80%" width="80%" alt="NSGALLOW"/>

Upon investigation, it was determined that the alert was a false positive, attributed to a service account-related misconfiguration. Despite the initial appearance of a successful breach, further analysis revealed no unauthorized changes or suspicious activity on the system. See final report for findings and reasoning
<p align="center">
<img src="https://github.com/user-attachments/assets/3582efe4-aa88-4e36-9b6d-79799373b74e" height="80%" width="80%" alt="NSGALLOW"/>

Investigation and Analysis
Preparation:

Custom detection and logging rules were configured in Microsoft Sentinel, ensuring that all brute force attempts were captured and sent to the Log Analytics Workspace for analysis.

Detection:

The SIEM alert indicated a successful brute force attempt, which prompted immediate investigation. Initial indicators included a high volume of failed login attempts (over 600) followed by a single successful logon from an IP address outside the expected geographic region.
<p align="center">
<img src="https://github.com/user-attachments/assets/dd37d745-0a30-4da4-9874-dadaf5c233b0" height="80%" width="80%" alt="NSGALLOW"/>
  
Analysis:

The alert's geolocation data showed that the source IP originated from Lahore, Pakistan, a location not associated with any authorized access. The account in question was NT AUTHORITY\ANONYMOUS LOGON, commonly involved in such alerts.
Despite the alert indicating a "success," repeated login attempts continued from the same IP, suggesting that the attacker's access was not fully established.
Further research revealed that this scenario is a known issue, often related to service accounts and resulting in false positives for brute force detection. (I forgot to take more screenshots, I was having so much fun. I'll make sure not to forget in the next 2 incidents, I apologize.)

Containment:

Immediate actions were taken to prevent further attempts, including adjusting the Network Security Group (NSG) rules to restrict inbound traffic solely to known, trusted IP addresses.
A detailed review of the NSG settings was conducted to ensure no similar traffic could bypass the firewall in the future. (Usually this first goes through the Change Management Process where you would first file an RFC, or a Request For Change)

<p align="center">
<img src="https://github.com/user-attachments/assets/d15bb91a-a544-4a1d-87b6-f26bdd1bbae0" height="80%" width="80%" alt="NSGALLOW"/>

Conclusion:

The incident was ultimately classified as a false positive. However, the investigation highlighted the importance of robust firewall and NSG configurations to prevent such occurrences.


Final Report:

Date: August 12, 2024
Time: 12:03 PM
Incident: Brute Force Alert on windows-vm
Outcome: False Positive

Details:
The alert was triggered by a service account anomaly, resulting in an erroneous indication of a successful brute force attack. Continuous monitoring and repeated failed attempts from the same IP address suggested no real breach occurred. The false positive was confirmed through both system logs and external research.

Remediation:
The NSG rules were hardened to block all unauthorized traffic, limiting access to a specific, trusted IP range. These measures will help prevent similar false positives in the future and ensure that only legitimate traffic can reach the Azure VMs.

</details>

<details>
  <summary>Possible Malware Outbreak</summary>
  
  This is the second example.

</details>

<details>
  <summary>Possible Privilege Escalation</summary>
  
  This is the second example.

</details>
